# OTP-Java
A small and easy-to-use one-time password generator for Java according to [RFC 4226](https://tools.ietf.org/html/rfc4226) (HOTP) and [RFC 6238](https://tools.ietf.org/html/rfc6238) (TOTP).

## Usage
### HOTP (Counter-based one-time passwords)
##### Generation of HOTP object:

```java
String secret = "ABCDEFGHIJKLMNOP";
HOTPGenerator hotp = new HOTPGenerator(secret);
```

The default length of a generated code is six digits. You can change the default:
```java
String secret = "ABCDEFGHIJKLMNOP";
int passwordLength = 6;
HOTPGenerator hotp = new HOTPGenerator(passwordLength, secret);

// Get information about the generator
String secret = hotp.getSecret();
int passwordLength = hotp.getPasswordLength();
HMACAlgorithm algorithm = hotp.getAlgorithm();
```

##### Generation of HOTP code:
After creating an instance of the HOTPGenerator class, a code can be generated by using the `generate()` method:
```java
try {
    int counter = 5;
    String code = hotp.generate(counter);
    
    // To verify a token:
    boolean isValid = hotp.verify(code, counter);
} catch (IllegalStateException e) {
    // Handle error
}
```

### TOTP (Time-based one-time passwords)
##### Generation of TOTP object:
TOTPGenerator can accept more paramaters: `passwordLength`, `period`, `algorithm` and `secret`. The default values for passwordLength = 6, period = 30, algorithm = SHA1.

```java
String secret = "ABCDEFGHIJKLMNOP";
int passwordLength = 8; // Password length must be between 6 and 8
Duration period = Duration.ofSeconds(30); // This can of course be any number
HMACAlgorithm algorithm = HMACAlgorithm.SHA1; // SHA256 and SHA512 are also supported

TOTPGenerator totp = new TOTPGenerator(passwordLength, period, algorithm, secret);
```

##### Generation of TOTP code:
After creating an instance of the TOTPGenerator class, a code can be generated by using the `generate()` method, similarly with the HOTPGenerator class:
```java
try {
    String code = totp.generate();
    
    // To verify a token:
    boolean isValid = totp.verify(code);
} catch (IllegalStateException e) {
    // Handle error
}
```
The above code will generate a time-based one-time password based on the current time. The API supports, besides the current time, the creation of codes based on `timeSince1970`, `Date` and `Instant` values:

```java
try {
    String codeBasedOnCurrentTime = totp.generate();
    String codeBasedOnDate = totp.generate(new Date());
    String codeBasedOnSecondsSince1970 = totp.generate(9238346823);
    String codeBasedOnAnInstant = totp.generate(Instant.now());
    String codeBasedOnURI = totp.generate(new URI("otpauth://totp/issuer?secret=ABCDEFGHIJKLMNOP&algorithm=SHA1&digits=6&period=30"));
} catch (IllegalStateException e) {
    // Handle error
}
```

## Licence
OTP-Java is available under the MIT licence. See the LICENCE for more info.
